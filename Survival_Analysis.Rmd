---
title: "Breast cancer survival prediction"
author: "Yangyang Chen"
date: "`r Sys.Date()`"
output: pdf_document
---

**Description**
This is a dataset of breast cancer patients from a prospective study. Information including variables 1-14 were collected at the baseline, the column `Survival Months` records the length of following-up, and the column `Status` records the survival status of the patients at the end of their following-up. We are primarily interested in predicting the risk of death based on features 1-14.
1. Age

2. Race

3. Marital Status

4. T Stage: Adjusted AJCC 6th T

5. N Stage: Adjusted AJCC 6th N

6. 6th Stage: Breast Adjusted AJCC 6th Stage

7. Differentiate

8. Grade

9. A Stage: Regional — A neoplasm that has extended; Distant — A neoplasm that has spread to parts of the body remote from

10. Tumor Size: Each indicates exact size in millimeters.

11. Estrogen Status

12. Progesterone Status

13. Regional Node Examined

14. Reginol Node Positive

15. Survival Months

16. Status: Dead / Alive

**Analytical goal** (you may only address some of them but properly addressing more will improve the rate of your report):

1. Using variables 1-14 as the covariates to predict the risk of death.

2. Which factors (features) affect the risk significantly? Are there interacting effects?

3. Evaluate the performance of your model(s). Is your model achieving similar performance between the majority race group “White” and the minority “Black” (or “Black” + “Other”)? If not, could you try to improve the fairness (i.e., reducing the gap of prediction performance between the majority and minority) of your model(s)?

**Suggestions and tips:**
In the report, you should describe your final model and interpret its parameters in an accurate and useful manner. It is expected that you would first examine the _marginal distributions_ and _pairwise relationships_ between variables (e.g., to check to see whether any _nonlinearities_ are immediately obvious), that you would explore several candidate models, and explain why you selected your model.

Also, you should check for violations of regression model assumptions, influential observations, multicollinearity, etc. This project may involve _logistic or survival models_ not introduced in our class, which gives you a 5 points bonus. It would be great if you could be an active learner and figure out these challenges. In addition, model evaluation and fairness mentioned in the above Point 3 are interesting topics, on which you could try to explore.
It would be helpful to be clear about your motivation for carrying out certain analyses as well as to be clear about interpretations of fitted model parameters. Your report should include a _table_ summarizing parameter estimates associated with your final fitted model, characterizing predictor variables in a way that a reader can clearly understand.

Below you’ll find some aspects to be addressed in your report. These are just a few suggestions, but feel free to add your own input/creativity to the analysis:

• Data exploration: descriptive statistics and visualization. You might want to, for instance:

o Include _a descriptive table_ with summary statistics for all variables;

o Explore the _distribution of the outcome_ and consider potential _transformations_ (if necessary);

o See if there are any unusual observations and consider them as potential
_outliers/influential points_.

• In your regression model, be watchful for variables that are highly _correlated_ and be selective in the variables you will include in your analysis.

• Consider selective _interactions_ between variables.

• DO NOT IGNORE _MODEL DIAGNOSTICS_

# _EDA_
```{r, include = FALSE, message = FALSE, warning = FALSE}
library(tidyverse)
library(viridis)
library(modelr)
library(mgcv)
library(latex2exp)
library(leaps)
library(survival)
library(autoReg)

knitr::opts_chunk$set(
	echo = TRUE,
	warning = FALSE,
	fig.width = 8, 
  fig.height = 6,
  out.width = "90%"
)

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d

theme_set(theme_minimal() + theme(legend.position = "bottom"))
```

**Methods**

_1. Data Description_
```{r}
cancer_df = 
  read_csv("Project_2_data.csv") |> 
  janitor::clean_names() |> 
  as.data.frame()

# Change the factor variables
col_names = 
  cancer_df |> select_if(is.character) |> colnames() |> as.vector()

cancer_df[,col_names] = 
  lapply(cancer_df[,col_names], factor)

# Change character variable "Status" to binary variables
cancer_df = 
  cancer_df |> 
  mutate(
    status = 
      case_match(
        status,
        "Alive" ~ 0,
        "Dead" ~ 1)
  )
```
The numeric descriptive statistics are:

`r cancer_df |> select_if(is.numeric) |> summary() |> knitr::kable(digits = 3)`


```{r}
age_plt = 
  cancer_df |> 
  ggplot(aes(x = tumor_size)) +
  geom_density(color = "blue", fill = "blue", alpha = 0.1) +
  labs(
    title = "age density plot",
    x = "age"
  )

tumor_size_plt = 
  cancer_df |> 
  ggplot(aes(x = tumor_size)) +
  geom_density(color = "blue", fill = "blue", alpha = 0.1) +
  labs(
    title = "tumor size density plot",
    x = "tumor size"
  )

reg_node_exam_plt = 
  cancer_df |> 
  ggplot(aes(x = regional_node_examined)) +
  geom_density(color = "blue", fill = "blue", alpha = 0.1) +
  labs(
    title = "regional node examined density plot",
    x = "regional node examined"
  )

reg_node_pos_plt = 
  cancer_df |> 
  ggplot(aes(x = reginol_node_positive)) +
  geom_density(color = "blue", fill = "blue", alpha = 0.1) +
  labs(
    title = "regional node positve density plot",
    x = "regional node positive"
  )

months_plt = 
  cancer_df |> 
  ggplot(aes(x = survival_months)) +
  geom_density(color = "blue", fill = "blue", alpha = 0.1) +
  labs(
    title = "survival_months density plot",
    x = "survival_months"
  )

gridExtra::grid.arrange(
  age_plt, 
  tumor_size_plt, 
  reg_node_exam_plt,
  reg_node_pos_plt, 
  months_plt, 
  nrow = 2,
  ncol = 3)
```

Comparing all numeric variables distribution, we have decided to conduct log-transform on `reginol_node_positive` variable:

```{r}
org_reg_plt = 
  cancer_df |> 
  ggplot(aes(x = reginol_node_positive)) +
  geom_density(color = "blue", fill = "blue", alpha = 0.1) +
  labs(
    title = "regional node positve density plot",
    x = "regional node positive"
  )

log_reg_plt = 
  cancer_df |> 
  ggplot(aes(x = log(reginol_node_positive))) +
  geom_density(color = "blue", fill = "blue", alpha = 0.1) +
  labs(
    title = "regional node positve density plot",
    x = "regional node positive"
  )
gridExtra::grid.arrange(org_reg_plt, log_reg_plt, nrow = 1)
```

Comparing plots before and after log-transformation, we decided to  abandoned log-transform on `reginol_node_positive` variable and adopt other methods to analyze.

# Results

## Univariate Analysis

```{r message=FALSE, echo=FALSE}
#load relevant packages
library(survminer)
library(survival)
library(ggplot2)
library(tidyverse)
library(My.stepwise)
library(corrr)
library(gtools)

#import data
cancer_df =
  read_csv("Project_2_data.csv") |>
  janitor::clean_names() |>
  as.data.frame()

# Change the factor variables
col_names =
  cancer_df |> select_if(is.character) |> colnames() |> as.vector()

#variable summary. Output not shown
variablesummary <- lapply(cancer_df[,1:14], table)

# Change character variable "Status" to binary variables
cancer_df = 
  cancer_df |> 
  mutate(
    status = 
      case_match(
        status,
        "Alive" ~ 0,
        "Dead" ~ 1)
  )

res.cor <- correlate(cancer_df[,1:14])
cancer_cor <- res.cor %>% stretch()
cancer_cor[is.na(cancer_cor)]<-0

corr_plot = 
  cancer_cor %>%
  ggplot(aes(x, y, col=r)) + 
  geom_tile(col="white", fill="white") +
  geom_point(aes(size = abs(r)), shape=16) +
  labs(x = "", y = "", col = "Correlation \nCoefficient", title="Correlation Plot") +
  scale_color_gradient2(low="#2903e8",high="#c7000d",mid="#fbfef9", limits=c(-1,1))+
  scale_x_discrete(expand = c(0,0),labels=c("age", "race", "marital status", "t stage", "n stage", "6th stage", "differentiate", "grade", "a stage", "tumor size", "estrogen status", "progesterone status", "regional node examined", "reginol node positive")) +
  scale_y_discrete(expand = c(0,0), labels = c("age", "race", "marital status", "t stage", "n stage", "6th stage", "differentiate", "grade", "a stage", "tumor size", "estrogen status", "progesterone status", "regional node examined", "reginol node positive")) +
  scale_size(range=c(1,8), guide = NULL)+
  theme(axis.line = element_line(colour = "black", 
                      linewidth = 1, linetype = "solid"),
        axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))

cancer_df = 
  cancer_df |> 
  mutate(
    agequant = quantcut(age,4),
    tumor_size_quant = quantcut(tumor_size,4),
    regional_examined_quant = quantcut(regional_node_examined,4),
    reginol_positive_quant = quantcut(reginol_node_positive,4)
  )

KM_age <- survfit(Surv(survival_months, status)~agequant, data = cancer_df)
KM_tumor_size <- survfit(Surv(survival_months, status)~tumor_size_quant, data = cancer_df)
KM_reginol_positive <- survfit(Surv(survival_months, status)~reginol_positive_quant, data = cancer_df)
KM_race = survfit(Surv(survival_months, status)~race, data = cancer_df)
KM_marital = survfit(Surv(survival_months, status)~marital_status, data = cancer_df)
KM_t_stage = survfit(Surv(survival_months, status)~t_stage, data = cancer_df)
KM_n_stage = survfit(Surv(survival_months, status)~n_stage, data = cancer_df)
KM_6_stage = survfit(Surv(survival_months, status)~x6th_stage, data = cancer_df)
KM_diff = survfit(Surv(survival_months, status)~differentiate, data = cancer_df)
KM_grade = survfit(Surv(survival_months, status)~grade, data = cancer_df)
KM_a_stage = survfit(Surv(survival_months, status)~a_stage, data = cancer_df)
KM_estrogen = survfit(Surv(survival_months, status)~estrogen_status, data = cancer_df)
KM_progesterone = survfit(Surv(survival_months, status)~progesterone_status, data = cancer_df)

KMplots_age<- ggsurvplot(fit = KM_age, data = cancer_df, conf.int = F, title = "Age", ylab = "Survival Probability", xlab = "Months", pval = T,legend.labs = c("30-47", "54-61", "47-54", "61-69"), legend.title = "", palette = c("#d702cc","#8702e0", "#2903e8", "#c7000d"), ggtheme = theme_bw())

KMplots_tumor <- ggsurvplot(fit = KM_tumor_size, data = cancer_df, conf.int = F, title = "Tumor Size (mm)", ylab = "Survival Probability", xlab = "Months", pval = T, legend.labs = c("1-16mm", "17-25mm", "26-38mm", "39-140mm%"), legend.title ="", palette = c("#d702cc","#8702e0", "#2903e8", "#c7000d"), ggtheme = theme_bw())

KMplots_positive <- ggsurvplot(fit = KM_reginol_positive, data = cancer_df, conf.int = F, title = "Reginol Node Positive", ylab = "Survival Probability", xlab = "Months", pval = T, legend.labs = c("1", "2", "3-5", "6-46"), legend.title ="", palette = c("#d702cc","#8702e0", "#2903e8", "#c7000d"), ggtheme = theme_bw())

KMplots_race<- ggsurvplot(fit = KM_race, data = cancer_df, conf.int = F, title = "Race", ylab = "Survival Probability", xlab = "Months", pval = T,legend.labs = c("Black", "Other", "White" ), legend.title = "", palette = c("#8702e0", "#2903e8", "#c7000d"), ggtheme = theme_bw())

KMplots_marital<- ggsurvplot(fit = KM_marital, data = cancer_df, conf.int = F, title = "Marital Status", ylab = "Survival Probability", xlab = "Months", pval = T,legend.labs = c("Divorced", "Married", "Separated", "Single", "Widowed"), legend.title = "", palette = c("#d702cc","#8702e0", "#2903e8", "#c7000d", "#006400"), ggtheme = theme_bw())

KMplots_t_stage<- ggsurvplot(fit = KM_t_stage, data = cancer_df, conf.int = F, title = "T Stage: Adjusted AJCC 6th T", ylab = "Survival Probability", xlab = "Months", pval = T,legend.labs = c("T1", "T2", "T3", "T4" ), legend.title = "", palette = c("#006400", "#8702e0", "#2903e8", "#c7000d"), ggtheme = theme_bw())

KMplots_n_stage<- ggsurvplot(fit = KM_n_stage, data = cancer_df, conf.int = F, title = "N Stage: Adjusted AJCC 6th N", ylab = "Survival Probability", xlab = "Months", pval = T,legend.labs = c("N1", "N2", "N3" ), legend.title = "", palette = c("#8702e0", "#2903e8", "#c7000d"), ggtheme = theme_bw())

KMplots_6_stage<- ggsurvplot(fit = KM_6_stage, data = cancer_df, conf.int = F, title = "6th Stage: Breast Adjusted AJCC 6th Stage", ylab = "Survival Probability", xlab = "Months", pval = T,legend.labs = c("Moderately differentiated", "Married", "Separated", "Single", "Widowed"), legend.title = "", palette = c("#d702cc","#8702e0", "#2903e8", "#c7000d", "#006400"), ggtheme = theme_bw())

KMplots_diff<- ggsurvplot(fit = KM_diff, data = cancer_df, conf.int = F, title = "Differentiate", ylab = "Survival Probability", xlab = "Months", pval = T,legend.labs = c("Moderately", "Poorly", "Undifferentiated", "Well"), legend.title = "", palette = c("#8702e0", "#2903e8", "#c7000d", "#006400"), ggtheme = theme_bw())

KMplots_grade<- ggsurvplot(fit = KM_grade, data = cancer_df, conf.int = F, title = "Grade", ylab = "Survival Probability", xlab = "Months", pval = T,legend.labs = c("1", "2", "3", "4 (anaplastic)"), legend.title = "", palette = c("#8702e0", "#2903e8", "#c7000d", "#006400"), ggtheme = theme_bw())

KMplots_a_stage<- ggsurvplot(fit = KM_a_stage, data = cancer_df, conf.int = F, title = "A Stage", ylab = "Survival Probability", xlab = "Months", pval = T,legend.labs = c("Distant", "Regional"), legend.title = "", palette = c("#2903e8", "#c7000d"), ggtheme = theme_bw())

KMplots_estrogen <- ggsurvplot(fit = KM_estrogen, data = cancer_df, conf.int = F, title = "Estrogen Status", ylab = "Survival Probability", xlab = "Months", pval = T,legend.labs = c("Negative", "Positive"), legend.title = "", palette = c("#2903e8", "#c7000d"), ggtheme = theme_bw())

KMplots_progesterone <- ggsurvplot(fit = KM_progesterone, data = cancer_df, conf.int = F, title = "Progesterone Status", ylab = "Survival Probability", xlab = "Months", pval = T,legend.labs = c("Negative", "Positive"), legend.title = "", palette = c("#2903e8", "#c7000d"), ggtheme = theme_bw())

#Kaplain-Meier estimators and plots for non-significant variables
KM_regional_examined <- survfit(Surv(survival_months, status)~regional_examined_quant, data = cancer_df)

KMplots_examined <- ggsurvplot(fit = KM_regional_examined, data = cancer_df, conf.int = F, title = "", ylab = "Survival Probability", xlab = "Months", pval = T, legend.labs = c("1-9", "10-14", "15-19", "20-61"), legend.title = "", palette = c("#d702cc","#8702e0", "#2903e8", "#c7000d"), ggtheme = theme_bw())

```

Kaplan-Meier plots of each variable with a significant log rank test result. Non-significant Kaplan-Meier plots can be found in Appendix A.
```{r message=FALSE}
KMplots_age
KMplots_tumor
```
**Figure 2.** Kaplan-Meier survival curves for blood pressure binary variable (left), and age variable (right). The survival time for individuals with high blood pressure is significantly different from individuals with normal blood pressure. Survival time for individuals aged 70 appears significantly different than all other age groups. P-values for log rank tests do not specify which group(s) are significantly different, however plots can be used to discern visual differences.

```{r message=FALSE}
# KMplots_positive
# KMplots_race
# KMplots_marital
# KMplots_t_stage
# KMplots_n_stage
# KMplots_6_stage
# KMplots_diff
# KMplots_grade
# KMplots_a_stage
# KMplots_estrogen
# KMplots_progesterone
```

# Model Interpretation and Discussion

# Conclusion

# Reference

# Appendix A:

Exploratory Analysis, Correlation Coefficient Plot, Kaplan-Meier plots with log rank test.
```{r}
#load relevant packages
library(survminer)
library(survival)
library(ggplot2)
library(tidyverse)
library(My.stepwise)
library(corrr)
library(gtools)

#import data
cancer_df =
  read_csv("Project_2_data.csv") |>
  janitor::clean_names() |>
  as.data.frame()

# Change the factor variables
col_names =
  cancer_df |> select_if(is.character) |> colnames() |> as.vector()

#variable summary. Output not shown
variablesummary <- lapply(cancer_df[,1:14], table)

# Change character variable "Status" to binary variables
cancer_df = 
  cancer_df |> 
  mutate(
    status = 
      case_match(
        status,
        "Alive" ~ 0,
        "Dead" ~ 1)
  )
```

```{r}
#correlation plot
res.cor <- correlate(cancer_df[,1:14])
cancer_cor <- res.cor %>% stretch()
cancer_cor[is.na(cancer_cor)]<-0

cancer_cor %>%
  ggplot(aes(x, y, col=r)) + 
  geom_tile(col="white", fill="white") +
  geom_point(aes(size = abs(r)), shape=16) +
  labs(x = "", y = "", col = "Correlation \nCoefficient", title="Correlation Plot") +
  scale_color_gradient2(low="#2903e8",high="#c7000d",mid="#fbfef9", limits=c(-1,1))+
  scale_x_discrete(expand = c(0,0),labels=c("age", "race", "marital status", "t stage", "n stage", "6th stage", "differentiate", "grade", "a stage", "tumor size", "estrogen status", "progesterone status", "regional node examined", "reginol node positive")) +
  scale_y_discrete(expand = c(0,0), labels = c("age", "race", "marital status", "t stage", "n stage", "6th stage", "differentiate", "grade", "a stage", "tumor size", "estrogen status", "progesterone status", "regional node examined", "reginol node positive")) +
  scale_size(range=c(1,8), guide = NULL)+
  theme(axis.line = element_line(colour = "black", 
                      linewidth = 1, linetype = "solid"),
        axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
```

```{r}
#divide continuous variables into quartiles
cancer_df = 
  cancer_df |> 
  mutate(
    agequant = quantcut(age,4),
    tumor_size_quant = quantcut(tumor_size,4),
    regional_examined_quant = quantcut(regional_node_examined,4),
    reginol_positive_quant = quantcut(reginol_node_positive,4)
  )
```

```{r}
#Kaplan-Meier estimators for significant variables. Plots found in Results section
KM_age <- survfit(Surv(survival_months, status)~agequant, data = cancer_df)
KM_tumor_size <- survfit(Surv(survival_months, status)~tumor_size_quant, data = cancer_df)
KM_reginol_positive <- survfit(Surv(survival_months, status)~reginol_positive_quant, data = cancer_df)
KM_race = survfit(Surv(survival_months, status)~race, data = cancer_df)
KM_marital = survfit(Surv(survival_months, status)~marital_status, data = cancer_df)
KM_t_stage = survfit(Surv(survival_months, status)~t_stage, data = cancer_df)
KM_n_stage = survfit(Surv(survival_months, status)~n_stage, data = cancer_df)
KM_6_stage = survfit(Surv(survival_months, status)~x6th_stage, data = cancer_df)
KM_diff = survfit(Surv(survival_months, status)~differentiate, data = cancer_df)
KM_grade = survfit(Surv(survival_months, status)~grade, data = cancer_df)
KM_a_stage = survfit(Surv(survival_months, status)~a_stage, data = cancer_df)
KM_estrogen = survfit(Surv(survival_months, status)~estrogen_status, data = cancer_df)
KM_progesterone = survfit(Surv(survival_months, status)~progesterone_status, data = cancer_df)

KMplots_age<- ggsurvplot(fit = KM_age, data = cancer_df, conf.int = F, title = "Age", ylab = "Survival Probability", xlab = "Months", pval = T,legend.labs = c("30-47", "54-61", "47-54", "61-69"), legend.title = "", palette = c("#d702cc","#8702e0", "#2903e8", "#c7000d"), ggtheme = theme_bw())

KMplots_tumor <- ggsurvplot(fit = KM_tumor_size, data = cancer_df, conf.int = F, title = "Tumor Size (mm)", ylab = "Survival Probability", xlab = "Months", pval = T, legend.labs = c("1-16mm", "17-25mm", "26-38mm", "39-140mm%"), legend.title ="", palette = c("#d702cc","#8702e0", "#2903e8", "#c7000d"), ggtheme = theme_bw())

KMplots_positive <- ggsurvplot(fit = KM_reginol_positive, data = cancer_df, conf.int = F, title = "Reginol Node Positive", ylab = "Survival Probability", xlab = "Months", pval = T, legend.labs = c("1", "2", "3-5", "6-46"), legend.title ="", palette = c("#d702cc","#8702e0", "#2903e8", "#c7000d"), ggtheme = theme_bw())

KMplots_race<- ggsurvplot(fit = KM_race, data = cancer_df, conf.int = F, title = "Race", ylab = "Survival Probability", xlab = "Months", pval = T,legend.labs = c("Black", "Other", "White" ), legend.title = "", palette = c("#8702e0", "#2903e8", "#c7000d"), ggtheme = theme_bw())

KMplots_marital<- ggsurvplot(fit = KM_marital, data = cancer_df, conf.int = F, title = "Marital Status", ylab = "Survival Probability", xlab = "Months", pval = T,legend.labs = c("Divorced", "Married", "Separated", "Single", "Widowed"), legend.title = "", palette = c("#d702cc","#8702e0", "#2903e8", "#c7000d", "#006400"), ggtheme = theme_bw())

KMplots_t_stage<- ggsurvplot(fit = KM_t_stage, data = cancer_df, conf.int = F, title = "T Stage: Adjusted AJCC 6th T", ylab = "Survival Probability", xlab = "Months", pval = T,legend.labs = c("T1", "T2", "T3", "T4" ), legend.title = "", palette = c("#006400", "#8702e0", "#2903e8", "#c7000d"), ggtheme = theme_bw())

KMplots_n_stage<- ggsurvplot(fit = KM_n_stage, data = cancer_df, conf.int = F, title = "N Stage: Adjusted AJCC 6th N", ylab = "Survival Probability", xlab = "Months", pval = T,legend.labs = c("N1", "N2", "N3" ), legend.title = "", palette = c("#8702e0", "#2903e8", "#c7000d"), ggtheme = theme_bw())

KMplots_6_stage<- ggsurvplot(fit = KM_6_stage, data = cancer_df, conf.int = F, title = "6th Stage: Breast Adjusted AJCC 6th Stage", ylab = "Survival Probability", xlab = "Months", pval = T,legend.labs = c("Moderately differentiated", "Married", "Separated", "Single", "Widowed"), legend.title = "", palette = c("#d702cc","#8702e0", "#2903e8", "#c7000d", "#006400"), ggtheme = theme_bw())

KMplots_diff<- ggsurvplot(fit = KM_diff, data = cancer_df, conf.int = F, title = "Differentiate", ylab = "Survival Probability", xlab = "Months", pval = T,legend.labs = c("Moderately", "Poorly", "Undifferentiated", "Well"), legend.title = "", palette = c("#8702e0", "#2903e8", "#c7000d", "#006400"), ggtheme = theme_bw())

KMplots_grade<- ggsurvplot(fit = KM_grade, data = cancer_df, conf.int = F, title = "Grade", ylab = "Survival Probability", xlab = "Months", pval = T,legend.labs = c("1", "2", "3", "4 (anaplastic)"), legend.title = "", palette = c("#8702e0", "#2903e8", "#c7000d", "#006400"), ggtheme = theme_bw())

KMplots_a_stage<- ggsurvplot(fit = KM_a_stage, data = cancer_df, conf.int = F, title = "A Stage", ylab = "Survival Probability", xlab = "Months", pval = T,legend.labs = c("Distant", "Regional"), legend.title = "", palette = c("#2903e8", "#c7000d"), ggtheme = theme_bw())

KMplots_estrogen <- ggsurvplot(fit = KM_estrogen, data = cancer_df, conf.int = F, title = "Estrogen Status", ylab = "Survival Probability", xlab = "Months", pval = T,legend.labs = c("Negative", "Positive"), legend.title = "", palette = c("#2903e8", "#c7000d"), ggtheme = theme_bw())

KMplots_progesterone <- ggsurvplot(fit = KM_progesterone, data = cancer_df, conf.int = F, title = "Progesterone Status", ylab = "Survival Probability", xlab = "Months", pval = T,legend.labs = c("Negative", "Positive"), legend.title = "", palette = c("#2903e8", "#c7000d"), ggtheme = theme_bw())
```

```{r}
#Kaplain-Meier estimators and plots for non-significant variables
KM_regional_examined <- survfit(Surv(survival_months, status)~regional_examined_quant, data = cancer_df)

KMplots_examined <- ggsurvplot(fit = KM_regional_examined, data = cancer_df, conf.int = F, title = "", ylab = "Survival Probability", xlab = "Months", pval = T, legend.labs = c("1-9", "10-14", "15-19", "20-61"), legend.title = "", palette = c("#d702cc","#8702e0", "#2903e8", "#c7000d"), ggtheme = theme_bw())

KMplots_examined
```

